# CodeKriti 4.0 Verification Checker App - Product & Design Specification

## 1. Project Overview
**Product Name:** CodeKriti Verifier
**Type:** Progressive Web App (PWA) / Mobile-Responsive Web App
**Purpose:** To streamline the event check-in process by scanning participant QR codes (generated by digital tickets), verifying their validity against the central Google Sheets database, and marking them as "Attended/Verified" in real-time.

---

## 2. Core Features

### A. Authentication
- **Simple Admin Login:** A secure PIN/Password screen to prevent unauthorized access.
- **Config persistence:** Remember the login state locally.

### B. QR Code Scanner
- **Camera Interface:** Full-screen or large docked camera view.
- **Auto-Detection:** Automatically detect and parse QR codes containing JSON data or confirmation IDs.
- **Flashlight Support:** Toggle for low-light environments.
- **Camera Switcher:** Front/Back camera toggle.

### C. Validation Logic
1.  **Parse:** Extract `Confirmation ID` (e.g., `CK-123456`) from the QR payload.
2.  **Fetch:** Query the Google Sheets database via the Apps Script API.
3.  **Validate:**
    *   **Exists?** Is the ID found in the database?
    *   **Duplicate?** Has this ID already been verified?
4.  **Result:** Display specific feedback:
    *   ✅ **Access Granted:** Valid ID, First scan. (Action: Update sheet status to "Verified").
    *   ⚠️ **Already Scanned:** Valid ID, but verified previously (Show time of previous scan).
    *   ❌ **Invalid Ticket:** ID not found.

### D. Manual Entry Fallback
- Input field to manually type the Confirmation ID if the QR code is damaged or unreadable.

### E. Dashboard & History
- **Real-time Stats:** Total Verified Count / Remaining Count (if total known).
- **Recent Scans:** A list of the last 50 scans with name, ID, status, and timestamp.
- **Unscanned List:** (Optional/Advanced) Fetch all "Unverified" users to easily identify pending arrivals.

---

## 3. Technical Architecture or Structure

### Frontend Stack (Recommended)
- **Framework:** React + Vite (Fast, lightweight).
- **Language:** TypeScript.
- **Styling:** Tailwind CSS + Shadcn UI (Matches main website aesthetic).
- **QR Library:** `html5-qrcode` (Robust, handles various devices well) or `react-qr-reader`.
- **State Management:** React Context or Zustand (For history and auth state).
- **Icons:** Lucide React.
- **Hosting:** Vercel / Netlify.

### Backend Integration (Google Apps Script)
The existing Google Apps Script needs to be updated to support a `VERIFY` action.

**Communication Flow:**
1.  App sends `POST` request to `GOOGLE_SCRIPT_URL`.
2.  Body: `{ action: "VERIFY_TICKET", id: "CK-XXXXXX", adminSecret: "YOUR_SECRET" }`
3.  Script searches `Registrations` sheet for `id`.
4.  If found:
    *   Check `Status` column.
    *   If `Pending`: Update to `Verified` + Timestamp. Return `Success`.
    *   If `Verified`: Return `Already Verified`.
    *   Return User Name & Event Details for display.
5.  If not found: Return `Error`.

---

## 4. UI/UX Design Description

### Theme
**"Cyber-Oceanic Security"** - Dark mode, cyan/neon blue accents, glassmorphism.
- **Background:** Deep #000814 (Same as main site).
- **Accents:** #00F3FF (Cyan) for valid, #EF4444 (Red) for error, #F59E0B (Amber) for warnings.

### Screen Flow

#### 1. Login Screen
- **Visuals:** Centered logo, glossy input field for "Access Code".
- **Action:** Enter PIN -> Unlock Scanner.

#### 2. Main Scanner Interface
- **Top Bar:** "CodeKriti Verifier", Logout button.
- **Center:**
    - Camera Viewport with a scanning frame overlay (corners highlighted).
    - animated "Laser" line moving up/down.
- **Bottom Controls:**
    - "Manual Entry" Button.
    - "History" Toggle.
    - Flashlight/Camera flip icons.

#### 3. Verification Result Modal (Pop-up)
*Appears immediately after scan.*
- **Success:**
    - Large Green Checkmark animation.
    - **NAME:** [Participant Name]
    - **EVENT:** [Event Name]
    - **ID:** [CK-XXXXXX]
    - Sound: "Soft Chime".
- **Warning (Already Scanned):**
    - Large Amber Alert icon.
    - "Scanned at [Time]"
    - Sound: "Buzz/Alert".
- **Error:**
    - Large Red X.
    - "ID NOT FOUND"
    - Sound: "Error Bleep".

#### 4. History / Stats Panel (Slide-up Sheet)
- **Header:** Verified: 142 / Pending: 58
- **List:** Scrollable list of cards.
    - [Green Dot] **John Doe** - 10:42 AM
    - [Green Dot] **Jane Smith** - 10:40 AM

---

## 5. Security & Secrets

To ensure the system works securely:

1.  **Admin Secret:** Hardcode a simple hashed check or strict equality check in the frontend for Login.
2.  **API Security:** Pass an `adminSecret` in the API payload to the Google Sheet to prevent anyone with the URL from marking users as verified.
    *   *Store this in `.env` as `VITE_API_ADMIN_SECRET`.*

---

## 6. Implementation Steps for the "Next LLM/Developer"

### Step 1: Backend Update (Google Apps Script)
*Copy implementation logic from `Code.gs` (if available) and add this Case:*

```javascript
/* GOOGLE APPS SCRIPT SNIPPET */
function doPost(e) {
  const data = JSON.parse(e.postData.contents);
  
  if (data.action === "VERIFY_TICKET") {
    // 1. Verify Secret
    if (data.adminSecret !== "YOUR_SECURE_BACKEND_PASSWORD") {
       return ContentService.createTextOutput(JSON.stringify({ status: 'error', message: 'Unauthorized' }));
    }

    // 2. Search Sheet
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Registrations"); // Update Sheet Name
    const rows = sheet.getDataRange().getValues();
    
    // Assume Col A=ID, Col B=Status, Col C=Name... (Map dynamically)
    // Find Row...
    
    // 3. Update Logic
    // ...
    
    return ContentService.createTextOutput(JSON.stringify({ 
      status: 'success', 
      data: { name: "John Doe", event: "Hackathon", previouslyVerified: false } 
    }));
  }
}
```

### Step 2: Frontend Setup
1.  Initialize `vite` project.
2.  Install `html5-qrcode`.
3.  Create `useScanner` hook.
4.  Implement `API.ts` service interacting with the Google Script URL.

### Step 3: Testing
1.  Generate a test QR from the main site.
2.  Scan it with the app.
3.  Verify the Google Sheet updates instantly.

---

## 7. Data Schema (Google Sheets Recommendation)

Ensure your main Google Sheet has the following columns (headers in Row 1):

| ID (Unique) | Name | Email | Event | **Status** | **CheckInTime** |
| :--- | :--- | :--- | :--- | :--- | :--- |
| CK-123456 | Alice | ... | Solo | **Verified** | 2026-02-14 10:00 |
| CK-987654 | Bob | ... | Team | **Pending** | |

*The `Status` and `CheckInTime` columns should be updated by the script.*
